<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8" />
  <title>Qazaq Sign AI</title>

  <!-- MediaPipe -->
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>

  <!-- Three.js -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>

  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(120deg, #e0f2ff, #ffffff);
      color: #1f2937;
    }
    header {
      padding: 30px;
      text-align: center;
    }
    header h1 {
      font-size: 32px;
    }
    header p {
      color: #555;
    }
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .card {
      background: white;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
    }
    input, button {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      border-radius: 10px;
      margin-top: 10px;
      border: 1px solid #ccc;
    }
    button {
      background: #2563eb;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #1d4ed8;
    }
    #avatar3d {
      width: 100%;
      height: 260px;
      margin-top: 15px;
      border-radius: 14px;
      background: #eef2ff;
    }
    video, canvas {
      width: 100%;
      border-radius: 14px;
      margin-top: 10px;
    }
    .result {
      margin-top: 10px;
      font-size: 18px;
      font-weight: bold;
      text-align: center;
    }
    footer {
      text-align: center;
      padding: 20px;
      color: #666;
      font-size: 14px;
    }
  </style>
</head>

<body>

<header>
  <h1>ü§ü Qazaq Sign AI</h1>
  <p>“ö–∞–∑–∞“õ —Ç—ñ–ª—ñ ‚Üî –´–º-–∏—à–∞—Ä–∞ | –ñ–ò –ø—Ä–æ—Ç–æ—Ç–∏–ø</p>
</header>

<div class="container">

  <!-- TEXT TO SIGN -->
  <div class="card">
    <h2>“ö–∞–∑–∞“õ—à–∞ –º”ô—Ç—ñ–Ω ‚Üí 3D –∞–≤–∞—Ç–∞—Ä</h2>
    <input id="textInput" placeholder="–º—ã—Å–∞–ª—ã: —Å”ô–ª–µ–º" />
    <button onclick="textToSign()">–ê—É–¥–∞—Ä—É</button>
    <div id="avatar3d"></div>
    <div class="result" id="avatarText">–°”©–∑ –∫“Ø—Ç—ñ–ª—É–¥–µ...</div>
  </div>

  <!-- SIGN TO TEXT -->
  <div class="card">
    <h2>–´–º-–∏—à–∞—Ä–∞ ‚Üí “ö–∞–∑–∞“õ—à–∞ –º”ô—Ç—ñ–Ω</h2>
    <video id="video" autoplay></video>
    <canvas id="canvas"></canvas>
    <div class="result" id="signResult">“ö–∏–º—ã–ª –∫“Ø—Ç—ñ–ª—É–¥–µ...</div>
  </div>

</div>

<footer>
  MVP Prototype ‚Ä¢ “ö–∞–∑–∞“õ —ã–º-–∏—à–∞—Ä–∞ —Ç—ñ–ª—ñ–Ω–µ “õ–æ–ª–¥–∞—É
</footer>

<script>
/* =========================
   3D AVATAR (Three.js)
========================= */
const scene = new THREE.Scene();
const camera3d = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
const container = document.getElementById("avatar3d");

renderer.setSize(container.clientWidth, container.clientHeight);
container.appendChild(renderer.domElement);

const light = new THREE.DirectionalLight(0xffffff, 1);
light.position.set(5, 5, 5);
scene.add(light);

const body = new THREE.Mesh(
  new THREE.BoxGeometry(1, 2, 0.6),
  new THREE.MeshStandardMaterial({ color: 0x2563eb })
);
scene.add(body);

const armMaterial = new THREE.MeshStandardMaterial({ color: 0x1e40af });
const leftArm = new THREE.Mesh(new THREE.BoxGeometry(0.3, 1, 0.3), armMaterial);
const rightArm = new THREE.Mesh(new THREE.BoxGeometry(0.3, 1, 0.3), armMaterial);

leftArm.position.set(-0.8, 0.3, 0);
rightArm.position.set(0.8, 0.3, 0);
body.add(leftArm);
body.add(rightArm);

camera3d.position.z = 4;

function animate() {
  requestAnimationFrame(animate);
  renderer.render(scene, camera3d);
}
animate();

/* TEXT ‚Üí SIGN */
const signs = {
  "—Å”ô–ª–µ–º": () => {
    avatarText.innerText = "üëã –°”ô–ª–µ–º";
    leftArm.rotation.z = Math.sin(Date.now() * 0.01) * 0.8;
    rightArm.rotation.z = -Math.sin(Date.now() * 0.01) * 0.8;
  },
  "—Ä–∞—Ö–º–µ—Ç": () => {
    avatarText.innerText = "üôè –†–∞—Ö–º–µ—Ç";
    leftArm.rotation.x = -1;
    rightArm.rotation.x = -1;
  },
  "–∏”ô": () => {
    avatarText.innerText = "üëç –ò”ô";
    rightArm.rotation.y = -1;
  },
  "–∂–æ“õ": () => {
    avatarText.innerText = "üëé –ñ–æ“õ";
    rightArm.rotation.y = 1;
  }
};

function textToSign() {
  const t = textInput.value.toLowerCase();
  if (signs[t]) {
    signs[t]();
  } else {
    avatarText.innerText = "‚ùå –ë“±–ª —Å”©–∑ –±–∞–∑–∞“ì–∞ –∂–æ“õ";
  }
}

/* =========================
   CAMERA HAND TRACKING
========================= */
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

const hands = new Hands({
  locateFile: file =>
    `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`
});

hands.setOptions({
  maxNumHands: 1,
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.7
});

hands.onResults(results => {
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if (results.multiHandLandmarks) {
    for (const landmarks of results.multiHandLandmarks) {
      drawConnectors(ctx, landmarks, HAND_CONNECTIONS, { color: "#2563eb" });
      drawLandmarks(ctx, landmarks, { color: "#1e40af" });

      const thumb = landmarks[4];
      const index = landmarks[8];

      if (thumb.y < index.y) {
        signResult.innerText = "–ò”ô";
      } else {
        signResult.innerText = "–ñ–æ“õ";
      }
    }
  }
});

const camera = new Camera(video, {
  onFrame: async () => {
    await hands.send({ image: video });
  },
  width: 640,
  height: 480
});
camera.start();
</script>

</body>
</html>
